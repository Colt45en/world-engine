<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä NEXUS Analytics Dashboard - Data Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a2a 0%, #1a1a3a 50%, #0a0a1a 100%);
            color: #e0e0ff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
        }

        .dashboard-container {
            display: grid;
            grid-template-areas:
                "header header header"
                "ai-analytics math-analytics system-analytics"
                "performance-charts learning-progress network-flow"
                "data-export prediction-engine alerts-analytics";
            grid-template-rows: 70px 1fr 1fr 100px;
            grid-template-columns: 1fr 1fr 1fr;
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }

        .dashboard-panel {
            background: rgba(20, 30, 60, 0.9);
            border: 1px solid #4466aa;
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }

        .dashboard-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #00ffff, #0080ff, #8000ff, #ff00ff);
            opacity: 0.8;
        }

        .header {
            grid-area: header;
            background: linear-gradient(45deg, rgba(0,255,255,0.3), rgba(128,0,255,0.3));
            border-color: #00ffff;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #00ffff, #8000ff, #ff00ff);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .time-controls {
            display: flex;
            gap: 10px;
        }

        .time-btn {
            background: transparent;
            border: 1px solid #4466aa;
            color: #e0e0ff;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .time-btn:hover, .time-btn.active {
            background: #4466aa;
            color: #ffffff;
            box-shadow: 0 0 10px #4466aa;
        }

        .panel-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #00ffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-analytics {
            grid-area: ai-analytics;
            border-color: #ff6600;
        }

        .math-analytics {
            grid-area: math-analytics;
            border-color: #00ff66;
        }

        .system-analytics {
            grid-area: system-analytics;
            border-color: #6600ff;
        }

        .performance-charts {
            grid-area: performance-charts;
            border-color: #ffff00;
        }

        .learning-progress {
            grid-area: learning-progress;
            border-color: #ff0066;
        }

        .network-flow {
            grid-area: network-flow;
            border-color: #66ff00;
        }

        .data-export {
            grid-area: data-export;
            border-color: #ff6600;
        }

        .prediction-engine {
            grid-area: prediction-engine;
            border-color: #00ffff;
        }

        .alerts-analytics {
            grid-area: alerts-analytics;
            border-color: #ff0000;
        }

        .chart-container {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #2244aa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
            height: 200px;
            overflow: hidden;
        }

        .chart-svg {
            width: 100%;
            height: 100%;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #334466;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 11px;
            color: #aaccff;
            text-transform: uppercase;
        }

        .progress-bar {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #334466;
            border-radius: 20px;
            height: 24px;
            margin: 8px 0;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #ffff00, #ff6600);
            border-radius: 20px;
            transition: width 1s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: progressShine 2s linear infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .data-flow {
            position: relative;
            height: 150px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #334466;
            border-radius: 8px;
            margin: 10px 0;
            overflow: hidden;
        }

        .flow-node {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .flow-ai {
            top: 20px;
            left: 20px;
            border-color: #ff6600;
            color: #ff6600;
        }

        .flow-math {
            top: 20px;
            right: 20px;
            border-color: #00ff66;
            color: #00ff66;
        }

        .flow-system {
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            border-color: #6600ff;
            color: #6600ff;
        }

        .flow-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: dataFlow 3s linear infinite;
        }

        @keyframes dataFlow {
            0% { opacity: 0; transform: scaleX(0); }
            50% { opacity: 1; transform: scaleX(1); }
            100% { opacity: 0; transform: scaleX(0); }
        }

        .connection-1 {
            top: 40px;
            left: 60px;
            right: 60px;
        }

        .connection-2 {
            bottom: 60px;
            left: 40px;
            width: 100px;
            transform: rotate(-45deg);
            transform-origin: left center;
        }

        .connection-3 {
            bottom: 60px;
            right: 40px;
            width: 100px;
            transform: rotate(45deg);
            transform-origin: right center;
        }

        .export-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: linear-gradient(45deg, #004466, #0066aa);
            border: 1px solid #4466aa;
            color: #ffffff;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: linear-gradient(45deg, #0066aa, #0088cc);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(68, 102, 170, 0.4);
        }

        .prediction-display {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #334466;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
        }

        .prediction-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 8px;
        }

        .prediction-confidence {
            font-size: 14px;
            color: #aaccff;
        }

        .alert-list {
            max-height: 120px;
            overflow-y: auto;
        }

        .alert-item {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            border-radius: 6px;
            padding: 8px;
            margin: 4px 0;
            font-size: 12px;
        }

        .alert-critical {
            border-color: #ff0000;
            background: rgba(255, 0, 0, 0.2);
        }

        .alert-warning {
            border-color: #ffaa00;
            background: rgba(255, 170, 0, 0.1);
        }

        .alert-info {
            border-color: #00aaff;
            background: rgba(0, 170, 255, 0.1);
        }

        .trend-indicator {
            display: inline-block;
            margin-left: 8px;
            font-size: 14px;
        }

        .trend-up {
            color: #00ff00;
        }

        .trend-down {
            color: #ff4444;
        }

        .trend-stable {
            color: #ffaa00;
        }

        .mini-chart {
            width: 100%;
            height: 60px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin: 8px 0;
            position: relative;
            overflow: hidden;
        }

        .chart-line {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #00ffff, #0080ff);
            animation: chartUpdate 5s linear infinite;
        }

        @keyframes chartUpdate {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-20px); }
            50% { transform: translateY(-40px); }
            75% { transform: translateY(-20px); }
        }

        .learning-stage {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }

        .stage-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 12px;
        }

        .stage-complete {
            background: #00ff00;
            box-shadow: 0 0 8px #00ff00;
        }

        .stage-current {
            background: #ffff00;
            box-shadow: 0 0 8px #ffff00;
            animation: pulse 2s infinite;
        }

        .stage-pending {
            background: #666666;
            border: 1px solid #aaaaaa;
        }

        .realtime-counter {
            font-size: 18px;
            font-weight: bold;
            color: #00ffff;
            text-align: center;
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-panel header">
            <div class="dashboard-title">üìä NEXUS Analytics Dashboard</div>
            <div class="time-controls">
                <button class="time-btn active" data-range="1h">1H</button>
                <button class="time-btn" data-range="6h">6H</button>
                <button class="time-btn" data-range="24h">24H</button>
                <button class="time-btn" data-range="7d">7D</button>
                <button class="time-btn" data-range="30d">30D</button>
            </div>
        </div>

        <!-- AI Analytics -->
        <div class="dashboard-panel ai-analytics">
            <div class="panel-title">ü§ñ AI Analytics</div>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="aiSessions">247</div>
                    <div class="stat-label">Sessions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="aiAccuracy">96.4%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="aiPatterns">1,456</div>
                    <div class="stat-label">Patterns</div>
                </div>
            </div>
            <div class="mini-chart">
                <div class="chart-line" id="aiTrendLine"></div>
            </div>
            <div>Training Efficiency: 94.2% <span class="trend-indicator trend-up">‚Üó</span></div>
        </div>

        <!-- Mathematical Analytics -->
        <div class="dashboard-panel math-analytics">
            <div class="panel-title">üî¢ Mathematical Analytics</div>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="mathCalcs">3,247</div>
                    <div class="stat-label">Calculations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="vectorOps">892</div>
                    <div class="stat-label">Vector Ops</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="precision">8</div>
                    <div class="stat-label">Precision</div>
                </div>
            </div>
            <div class="mini-chart">
                <div class="chart-line" id="mathTrendLine"></div>
            </div>
            <div>Computation Rate: 247/sec <span class="trend-indicator trend-stable">‚Üí</span></div>
        </div>

        <!-- System Analytics -->
        <div class="dashboard-panel system-analytics">
            <div class="panel-title">‚öôÔ∏è System Analytics</div>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="systemUptime">99.7%</div>
                    <div class="stat-label">Uptime</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="systemLoad">34%</div>
                    <div class="stat-label">CPU Load</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="errorRate">0.03%</div>
                    <div class="stat-label">Error Rate</div>
                </div>
            </div>
            <div class="mini-chart">
                <div class="chart-line" id="systemTrendLine"></div>
            </div>
            <div>Performance Index: 94.8 <span class="trend-indicator trend-up">‚Üó</span></div>
        </div>

        <!-- Performance Charts -->
        <div class="dashboard-panel performance-charts">
            <div class="panel-title">üìà Performance Trends</div>
            <div class="chart-container">
                <svg class="chart-svg" id="performanceChart">
                    <!-- Chart will be generated by JavaScript -->
                </svg>
            </div>
            <div class="realtime-counter" id="performanceCounter">Real-time: 247 ops/sec</div>
        </div>

        <!-- Learning Progress -->
        <div class="dashboard-panel learning-progress">
            <div class="panel-title">üéì Learning Progress</div>
            <div class="learning-stage">
                <div class="stage-indicator stage-complete"></div>
                <div>Basic Mathematics</div>
            </div>
            <div class="learning-stage">
                <div class="stage-indicator stage-complete"></div>
                <div>Pythagorean Theorem</div>
            </div>
            <div class="learning-stage">
                <div class="stage-indicator stage-current"></div>
                <div>Vector Operations</div>
            </div>
            <div class="learning-stage">
                <div class="stage-indicator stage-pending"></div>
                <div>Advanced Calculus</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="learningProgress"></div>
            </div>
            <div>Overall Progress: <span id="progressPercent">67%</span></div>
        </div>

        <!-- Network Flow -->
        <div class="dashboard-panel network-flow">
            <div class="panel-title">üåê Data Flow</div>
            <div class="data-flow">
                <div class="flow-node flow-ai">AI</div>
                <div class="flow-node flow-math">MATH</div>
                <div class="flow-node flow-system">SYS</div>
                <div class="flow-connection connection-1"></div>
                <div class="flow-connection connection-2"></div>
                <div class="flow-connection connection-3"></div>
            </div>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="dataPackets">15.2K</div>
                    <div class="stat-label">Packets</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bandwidth">847KB/s</div>
                    <div class="stat-label">Bandwidth</div>
                </div>
            </div>
        </div>

        <!-- Data Export -->
        <div class="dashboard-panel data-export">
            <div class="panel-title">üíæ Data Export</div>
            <div class="export-controls">
                <button class="export-btn" id="exportJSON">JSON Data</button>
                <button class="export-btn" id="exportCSV">CSV Report</button>
                <button class="export-btn" id="exportPDF">PDF Summary</button>
                <button class="export-btn" id="exportAnalytics">Full Analytics</button>
            </div>
        </div>

        <!-- Prediction Engine -->
        <div class="dashboard-panel prediction-engine">
            <div class="panel-title">üîÆ Predictions</div>
            <div class="prediction-display">
                <div class="prediction-value" id="nextPrediction">15.7 min</div>
                <div class="prediction-confidence">Next AI breakthrough (89% confidence)</div>
            </div>
            <div class="prediction-display">
                <div class="prediction-value" id="performancePrediction">+12%</div>
                <div class="prediction-confidence">Performance improvement (76% confidence)</div>
            </div>
        </div>

        <!-- Alerts Analytics -->
        <div class="dashboard-panel alerts-analytics">
            <div class="panel-title">‚ö†Ô∏è Alert Analytics</div>
            <div class="alert-list" id="alertList">
                <div class="alert-item alert-info">System optimization completed</div>
                <div class="alert-item alert-warning">Memory usage approaching 75%</div>
                <div class="alert-item alert-info">AI training milestone reached</div>
                <div class="alert-item alert-critical">Connection timeout detected</div>
            </div>
        </div>
    </div>

    <script>
        class NexusAnalyticsDashboard {
            constructor() {
                this.timeRange = '1h';
                this.data = {
                    ai: [],
                    math: [],
                    system: [],
                    performance: []
                };
                this.animations = [];

                this.initializeDashboard();
            }

            initializeDashboard() {
                console.log('üìä NEXUS Analytics Dashboard initializing...');

                // Setup event handlers
                this.setupEventHandlers();

                // Start real-time data collection
                this.startDataCollection();

                // Initialize charts
                this.initializeCharts();

                // Start animations
                this.startAnimations();

                // Connect to NEXUS systems
                this.connectToNexusSystems();

                console.log('‚úÖ Analytics Dashboard ready');
            }

            setupEventHandlers() {
                // Time range selection
                document.querySelectorAll('.time-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.timeRange = e.target.dataset.range;
                        this.updateAllCharts();
                    });
                });

                // Export controls
                document.getElementById('exportJSON').addEventListener('click', () => this.exportData('json'));
                document.getElementById('exportCSV').addEventListener('click', () => this.exportData('csv'));
                document.getElementById('exportPDF').addEventListener('click', () => this.exportData('pdf'));
                document.getElementById('exportAnalytics').addEventListener('click', () => this.exportData('analytics'));
            }

            startDataCollection() {
                // Collect AI metrics
                setInterval(() => {
                    this.collectAIMetrics();
                }, 2000);

                // Collect mathematical metrics
                setInterval(() => {
                    this.collectMathMetrics();
                }, 1500);

                // Collect system metrics
                setInterval(() => {
                    this.collectSystemMetrics();
                }, 3000);

                // Update displays
                setInterval(() => {
                    this.updateDisplays();
                }, 1000);
            }

            collectAIMetrics() {
                const aiData = {
                    timestamp: Date.now(),
                    sessions: parseInt(document.getElementById('aiSessions').textContent) + Math.floor(Math.random() * 3),
                    accuracy: 96.4 + (Math.random() - 0.5) * 2,
                    patterns: parseInt(document.getElementById('aiPatterns').textContent.replace(',', '')) + Math.floor(Math.random() * 5),
                    efficiency: 94.2 + (Math.random() - 0.5) * 3
                };

                this.data.ai.push(aiData);
                this.limitDataSize('ai');

                // Update display
                document.getElementById('aiSessions').textContent = aiData.sessions;
                document.getElementById('aiAccuracy').textContent = aiData.accuracy.toFixed(1) + '%';
                document.getElementById('aiPatterns').textContent = aiData.patterns.toLocaleString();
            }

            collectMathMetrics() {
                const mathData = {
                    timestamp: Date.now(),
                    calculations: parseInt(document.getElementById('mathCalcs').textContent.replace(',', '')) + Math.floor(Math.random() * 10),
                    vectorOps: parseInt(document.getElementById('vectorOps').textContent) + Math.floor(Math.random() * 5),
                    precision: 8,
                    rate: 247 + Math.floor(Math.random() * 50 - 25)
                };

                this.data.math.push(mathData);
                this.limitDataSize('math');

                // Update display
                document.getElementById('mathCalcs').textContent = mathData.calculations.toLocaleString();
                document.getElementById('vectorOps').textContent = mathData.vectorOps;
            }

            collectSystemMetrics() {
                const systemData = {
                    timestamp: Date.now(),
                    uptime: 99.7 + (Math.random() - 0.5) * 0.1,
                    load: 34 + Math.floor(Math.random() * 20 - 10),
                    errorRate: 0.03 + (Math.random() - 0.5) * 0.02,
                    performance: 94.8 + (Math.random() - 0.5) * 2
                };

                this.data.system.push(systemData);
                this.limitDataSize('system');

                // Update display
                document.getElementById('systemUptime').textContent = systemData.uptime.toFixed(1) + '%';
                document.getElementById('systemLoad').textContent = Math.max(0, systemData.load) + '%';
                document.getElementById('errorRate').textContent = Math.max(0, systemData.errorRate).toFixed(2) + '%';
            }

            limitDataSize(category) {
                if (this.data[category].length > 100) {
                    this.data[category] = this.data[category].slice(-50);
                }
            }

            updateDisplays() {
                // Update real-time counter
                const rate = 247 + Math.floor(Math.random() * 50 - 25);
                document.getElementById('performanceCounter').textContent = `Real-time: ${rate} ops/sec`;

                // Update learning progress
                const currentProgress = parseFloat(document.getElementById('progressPercent').textContent);
                const newProgress = Math.min(100, currentProgress + Math.random() * 0.1);
                document.getElementById('progressPercent').textContent = newProgress.toFixed(1) + '%';
                document.getElementById('learningProgress').style.width = newProgress + '%';

                // Update data flow metrics
                const packets = parseInt(document.getElementById('dataPackets').textContent.replace('K', '').replace(',', '')) + Math.random() * 0.1;
                document.getElementById('dataPackets').textContent = packets.toFixed(1) + 'K';

                const bandwidth = 847 + Math.floor(Math.random() * 100 - 50);
                document.getElementById('bandwidth').textContent = Math.max(0, bandwidth) + 'KB/s';

                // Update predictions
                this.updatePredictions();
            }

            updatePredictions() {
                const predictions = [
                    { value: '15.7 min', text: 'Next AI breakthrough (89% confidence)' },
                    { value: '23.4 min', text: 'Next system optimization (76% confidence)' },
                    { value: '8.9 min', text: 'Next mathematical milestone (92% confidence)' }
                ];

                const randomPrediction = predictions[Math.floor(Math.random() * predictions.length)];
                document.getElementById('nextPrediction').textContent = randomPrediction.value;
                document.querySelector('#nextPrediction').nextElementSibling.textContent = randomPrediction.text;

                const performance = ['+12%', '+8%', '+15%', '-3%', '+9%'];
                const randomPerf = performance[Math.floor(Math.random() * performance.length)];
                document.getElementById('performancePrediction').textContent = randomPerf;
            }

            initializeCharts() {
                this.createPerformanceChart();
                this.updateAllCharts();
            }

            createPerformanceChart() {
                const svg = document.getElementById('performanceChart');
                const width = svg.clientWidth || 300;
                const height = svg.clientHeight || 150;

                svg.innerHTML = `
                    <defs>
                        <linearGradient id="chartGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#00ffff;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#0080ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#8000ff;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <polyline id="performanceLine" fill="none" stroke="url(#chartGradient)" stroke-width="2" />
                    <circle id="performancePoint" r="4" fill="#00ffff" />
                `;

                this.animateChart();
            }

            animateChart() {
                const line = document.getElementById('performanceLine');
                const point = document.getElementById('performancePoint');
                const svg = document.getElementById('performanceChart');
                const width = svg.clientWidth || 300;
                const height = svg.clientHeight || 150;

                let points = [];
                for (let i = 0; i < 20; i++) {
                    const x = (i / 19) * width;
                    const y = height - (Math.random() * 0.5 + 0.5) * (height - 20) - 10;
                    points.push(`${x},${y}`);
                }

                line.setAttribute('points', points.join(' '));

                if (points.length > 0) {
                    const lastPoint = points[points.length - 1].split(',');
                    point.setAttribute('cx', lastPoint[0]);
                    point.setAttribute('cy', lastPoint[1]);
                }

                setTimeout(() => this.animateChart(), 2000);
            }

            updateAllCharts() {
                // Update trend lines
                this.updateTrendLine('aiTrendLine');
                this.updateTrendLine('mathTrendLine');
                this.updateTrendLine('systemTrendLine');
            }

            updateTrendLine(elementId) {
                const element = document.getElementById(elementId);
                const height = Math.random() * 40 + 20;
                element.style.height = height + 'px';
                element.style.transform = `translateY(-${height}px)`;
            }

            startAnimations() {
                // Animate flow connections
                setInterval(() => {
                    document.querySelectorAll('.flow-connection').forEach((conn, index) => {
                        conn.style.animationDelay = index * 0.5 + 's';
                    });
                }, 3000);

                // Add random alert
                setInterval(() => {
                    this.addRandomAlert();
                }, 10000);
            }

            addRandomAlert() {
                const alerts = [
                    { type: 'info', text: 'AI training batch completed successfully' },
                    { type: 'warning', text: 'High computational load detected' },
                    { type: 'info', text: 'Mathematical optimization applied' },
                    { type: 'warning', text: 'Network latency increased' },
                    { type: 'info', text: 'System cache cleared' }
                ];

                const randomAlert = alerts[Math.floor(Math.random() * alerts.length)];
                const alertList = document.getElementById('alertList');

                const alertElement = document.createElement('div');
                alertElement.className = `alert-item alert-${randomAlert.type}`;
                alertElement.textContent = randomAlert.text;

                alertList.appendChild(alertElement);

                // Keep only last 10 alerts
                while (alertList.children.length > 10) {
                    alertList.removeChild(alertList.firstChild);
                }

                alertList.scrollTop = alertList.scrollHeight;
            }

            connectToNexusSystems() {
                // Listen for NEXUS system messages
                window.addEventListener('message', (event) => {
                    if (event.data.type && event.data.type.startsWith('nexus_')) {
                        this.handleNexusData(event.data);
                    }
                });

                // Listen for localStorage events
                window.addEventListener('storage', (event) => {
                    if (event.key && event.key.startsWith('nexus_')) {
                        try {
                            const data = JSON.parse(event.newValue);
                            this.handleNexusData(data);
                        } catch (e) {
                            // Ignore parse errors
                        }
                    }
                });

                // Announce dashboard ready
                this.broadcastMessage({
                    type: 'nexus_analytics_ready',
                    timestamp: Date.now()
                });
            }

            handleNexusData(data) {
                switch (data.type) {
                    case 'nexus_ai_update':
                        this.processAIUpdate(data);
                        break;
                    case 'nexus_math_calculation':
                        this.processMathUpdate(data);
                        break;
                    case 'nexus_system_status':
                        this.processSystemUpdate(data);
                        break;
                }
            }

            processAIUpdate(data) {
                if (data.sessions) {
                    document.getElementById('aiSessions').textContent = data.sessions;
                }
                if (data.accuracy) {
                    document.getElementById('aiAccuracy').textContent = data.accuracy.toFixed(1) + '%';
                }
            }

            processMathUpdate(data) {
                if (data.calculations) {
                    document.getElementById('mathCalcs').textContent = data.calculations.toLocaleString();
                }
            }

            processSystemUpdate(data) {
                if (data.uptime) {
                    document.getElementById('systemUptime').textContent = data.uptime.toFixed(1) + '%';
                }
            }

            exportData(format) {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    timeRange: this.timeRange,
                    data: this.data,
                    summary: {
                        aiSessions: parseInt(document.getElementById('aiSessions').textContent),
                        mathCalculations: parseInt(document.getElementById('mathCalcs').textContent.replace(',', '')),
                        systemUptime: parseFloat(document.getElementById('systemUptime').textContent),
                        learningProgress: parseFloat(document.getElementById('progressPercent').textContent)
                    }
                };

                switch (format) {
                    case 'json':
                        this.downloadJSON(exportData);
                        break;
                    case 'csv':
                        this.downloadCSV(exportData);
                        break;
                    case 'pdf':
                        this.generatePDFReport(exportData);
                        break;
                    case 'analytics':
                        this.downloadFullAnalytics(exportData);
                        break;
                }

                this.addRandomAlert();
                const alerts = document.getElementById('alertList');
                const successAlert = document.createElement('div');
                successAlert.className = 'alert-item alert-info';
                successAlert.textContent = `${format.toUpperCase()} export completed successfully`;
                alerts.appendChild(successAlert);
            }

            downloadJSON(data) {
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                this.downloadBlob(blob, `nexus-analytics-${Date.now()}.json`);
            }

            downloadCSV(data) {
                let csv = 'Timestamp,AI Sessions,Math Calculations,System Uptime,Learning Progress\n';
                csv += `${data.timestamp},${data.summary.aiSessions},${data.summary.mathCalculations},${data.summary.systemUptime},${data.summary.learningProgress}\n`;

                const blob = new Blob([csv], { type: 'text/csv' });
                this.downloadBlob(blob, `nexus-analytics-${Date.now()}.csv`);
            }

            generatePDFReport(data) {
                // Simulate PDF generation
                const pdfContent = `NEXUS Analytics Report
Generated: ${data.timestamp}
Time Range: ${data.timeRange}

AI Analytics:
- Sessions: ${data.summary.aiSessions}
- Accuracy: ${document.getElementById('aiAccuracy').textContent}

Mathematical Analytics:
- Calculations: ${data.summary.mathCalculations}
- Vector Operations: ${document.getElementById('vectorOps').textContent}

System Analytics:
- Uptime: ${data.summary.systemUptime}%
- Learning Progress: ${data.summary.learningProgress}%`;

                const blob = new Blob([pdfContent], { type: 'text/plain' });
                this.downloadBlob(blob, `nexus-analytics-report-${Date.now()}.txt`);
            }

            downloadFullAnalytics(data) {
                const fullData = {
                    ...data,
                    charts: this.getChartData(),
                    predictions: this.getPredictionData(),
                    alerts: this.getAlertData()
                };

                const blob = new Blob([JSON.stringify(fullData, null, 2)], { type: 'application/json' });
                this.downloadBlob(blob, `nexus-full-analytics-${Date.now()}.json`);
            }

            downloadBlob(blob, filename) {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.download = filename;
                link.href = url;
                link.click();
                URL.revokeObjectURL(url);
            }

            getChartData() {
                return {
                    performance: this.data.performance.slice(-20),
                    trends: {
                        ai: this.data.ai.slice(-20),
                        math: this.data.math.slice(-20),
                        system: this.data.system.slice(-20)
                    }
                };
            }

            getPredictionData() {
                return {
                    nextBreakthrough: document.getElementById('nextPrediction').textContent,
                    performanceImprovement: document.getElementById('performancePrediction').textContent
                };
            }

            getAlertData() {
                return Array.from(document.querySelectorAll('.alert-item')).map(alert => ({
                    type: alert.className.split(' ').pop().replace('alert-', ''),
                    message: alert.textContent
                }));
            }

            broadcastMessage(message) {
                // Broadcast to parent window
                if (window.parent !== window) {
                    window.parent.postMessage(message, '*');
                }

                // Store in localStorage for cross-system communication
                localStorage.setItem(`nexus_analytics_${Date.now()}`, JSON.stringify(message));
            }
        }

        // Initialize dashboard when page loads
        window.addEventListener('load', () => {
            window.nexusAnalytics = new NexusAnalyticsDashboard();
            console.log('üìä NEXUS Analytics Dashboard ready');
        });
    </script>
</body>
</html>
